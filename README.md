# remoteAudio
[![Build Status](https://travis-ci.org/dh1tw/remoteAudio.svg?branch=master)](https://travis-ci.org/dh1tw/remoteAudio)

remoteAudio is an audio streaming application, built for Amateur Radio purposes,
written in [Go](1). The most typical use case for this software is the remote
operation of an amateur radio station.

**ADVICE**: This project is **under development**. The parameters, ICD and the
behaviour is still **not stable** and subject to change.

## Supported Codecs

- [OPUS](2) (default)
- PCM (variable samplerate and 8/12/16/24 bit depth)

## Supported Transportation Protocols

- [MQTT](3)
- P2P protocol (UDP/TCP/ZEROMQ) will be added later

## Supported Platforms

RemoteAudio has been tested on:

- AMD64
- i386
- ARMv6
- ARMv8

## How to install remoteAudio on Linux (Ubuntu > 12.04)

```bash

    $ sudo apt install pkg-config libsamplerate0 libsamplerate0-dev libopusfile-dev libopus-dev libportaudio2 portaudio19-dev
    $ go get github.com/dh1tw/remoteAudio
    $ go install github.com/dh1tw/remoteAudio

```

## Requirements

In order to operate remoteAudio you need to either run your own MQTT Broker
([Mosquitto](4) is a good choice) or connect to a public broker, like
`iot.eclipse.org` or `test.mosquitto.org`. The load of these brokers
and their ping to your place obviously will influence the latency.


## Execute Audio Server

```bash

    $ remoteAudio serve mqtt

```

## Execute Audio Client

```bash

    $ remoteAudio connect mqtt

```

Both, the server and the client provide extensive configuration possibilities,
either through a configuration file (TOML|YAML|JSON), typically located in
your home directory `/home/your_user/.remoteAudio.toml`. or through pflags.

An example configuration file is included in the repository.

All parameters can be set through pflags. These are the options for the
server:

```

Server streaming Audio via MQTT

Usage:
  remoteAudio serve mqtt [flags]

Flags:
  -p, --broker_port int     Broker Port (default 1883)
  -u, --broker_url string   Broker URL (default "localhost")
  -c, --client_id string    MQTT Client Id
  -Y, --radio string        Radio ID (default "myradio")
  -X, --station string      Your station callsign (default "mystation")

Global Flags:
  -f, --audio_frame_length int              Amount of audio samples in one frame (default 480)
  -C, --codec string                        Audio codec (default "opus")
      --config string                       config file (default is $HOME/.remoteAudio.yaml)
      --input_device_channels string        Input Channels (default "mono")
      --input_device_latency duration       Input latency (default 5ms)
  -i, --input_device_name string            Input device (default "default")
      --input_device_sampling_rate float    Input device sampling rate (default 48000)
      --opus_application string             profile for opus encoder (default "restricted_lowdelay")
      --opus_bitrate int                    Bitrate (bits/sec) generated by the opus encoder (default 32000)
      --opus_complexity int                 Computational complexity of opus encoder (default 9)
      --opus_max_bandwidth string           maximum bandwidth of opus encoder (default "wideband")
      --output_device_channels string       Output Channels (default "stereo")
      --output_device_latency duration      Output latency (default 5ms)
  -o, --output_device_name string           Output device (default "default")
      --output_device_sampling_rate float   Output device sampling rate (default 48000)
      --pcm_bitdepth int                    pcm audio bit depth (8, 12, 16, 24 bit) (default 16)
      --pcm_channels string                 pcm audio Channels (default "stereo")
      --pcm_resampling_quality int          pcm resampling quality (default 1)
      --pcm_samplingrate float              pcm sampling rate (default 16000)
  -R, --rx_buffer_length int                Buffer length (in frames) for incoming Audio packets (default 10)
  -U, --user_id string                      Your User ID - required for TX

```

The Client provides a minimal Web Interface for basic control of the
client and server side audio streams. Open a Webbrowser at:
[http://localhost:6060](https://localhost:6060) to access the WebUI.

In any case, the client and server will accept almost any kind of audio frames
without any configuration. Internally remoteAudio picks the right codec,
resamples and adjust to the local audio output device.

However if the buffer size does not correspond to the internal buffer size,
the stream has to be restarted which might result in a small delay.

## Troubleshooting

remoteAudio does it's best to check if your sound hardware is compatible with
the parameters you have set. However it's not entirely possible to check all
the Settings.

Inexpensive (USB) Soundcards usually operate at 48kHz. They play the audio in
Stereo and Record the Audio in MONO.

Feel free to open an issue if you encounter problems.

## ToDo List

- [ ] Better Error Logging with various Error Levels and various sinks (File, MQTT,...)
- [ ] Improve Design of WebUI
- [ ] Implement a P2P Protocol (UDP / TCP / ZeroMQ / GRPC)
- [ ] Possibility to select Audio Channels (Left, Right or Both) through WebUI
- [ ] Bandwidth Monitor

[1]:https://golang.org
[2]:http://opus-codec.org
[3]:http://mqtt.org
[4]:https://mosquitto.org